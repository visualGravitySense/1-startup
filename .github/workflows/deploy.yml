name: üöÄ Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: üì• Checkout code
      uses: actions/checkout@v4
      
    - name: üîß Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: üì¶ Install dependencies (if needed)
      run: |
        if [ -f package.json ]; then
          npm ci
        else
          echo "No package.json found, skipping npm install"
        fi
        
    - name: üèóÔ∏è Build (if needed)
      run: |
        if [ -f package.json ] && [ -n "$(npm run | grep build)" ]; then
          npm run build
        else
          echo "No build script found, using static files"
        fi
        
    - name: üé® Prepare deployment files
      run: |
        # –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è –¥–µ–ø–ª–æ—è
        mkdir -p deploy
        
        # –ö–æ–ø–∏—Ä—É–µ–º HTML —Ñ–∞–π–ª—ã
        cp *.html deploy/ 2>/dev/null || echo "No HTML files found in root"
        
        # –ö–æ–ø–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
        if [ -d "css" ]; then cp -r css deploy/; fi
        if [ -d "js" ]; then cp -r js deploy/; fi
        if [ -d "images" ]; then cp -r images deploy/; fi
        if [ -d "assets" ]; then cp -r assets deploy/; fi
        if [ -d "fonts" ]; then cp -r fonts deploy/; fi
        
        # –ï—Å–ª–∏ –µ—Å—Ç—å build –ø–∞–ø–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ—ë
        if [ -d "build" ]; then
          cp -r build/* deploy/
        elif [ -d "dist" ]; then
          cp -r dist/* deploy/
        fi
        
        # –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ index.html –µ—Å—Ç—å –≤ –ø–∞–ø–∫–µ deploy
        if [ ! -f deploy/index.html ] && [ -f index.html ]; then
          cp index.html deploy/
        fi
        
        echo "Deployment files prepared:"
        ls -la deploy/
        
    - name: üöÄ Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      if: github.ref == 'refs/heads/main'
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./deploy
        cname: false # –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω –µ—Å–ª–∏ –Ω—É–∂–Ω–æ 